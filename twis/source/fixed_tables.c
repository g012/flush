#include "fixed.h"

// Arc Tangent 16 values
// Fixed Point Arc Tangent table, with the point at position Q
// All transcendental functions can be derived from this table
//
//    Binary           Q     ArcTan             Fixed ArcTan
// 0000000000000001.   0  .785400390625      .1100100100010000
// 000000000000000.1   1  .463653564453125   .0111011010110010
// 00000000000000.01   2  .2449798583984375  .0011111010110111
// 0000000000000.001   3  .124359130859375   .0001111111010110
// 000000000000.0001   4  .0624237060546875  .0000111111111011
// 00000000000.00001   5  .0312347412109375  .0000011111111111
// 0000000000.000001   6  .015625            .0000010000000000
// 000000000.0000001   7  .0078125           .0000001000000000
// 00000000.00000001   8  .00390625          .0000000100000000
// 0000000.000000001   9  .001953125         .0000000010000000
// 000000.0000000001  10  .0009765625        .0000000001000000
// 00000.00000000001  11  .00048828125       .0000000000100000
// 0000.000000000001  12  .000244140625      .0000000000010000
// 000.0000000000001  13  .0001220703125     .0000000000001000
// 00.00000000000001  14  .00006103515625    .0000000000000100
// 0.000000000000001  15  .000030517578125   .0000000000000010
// .0000000000000001  16  .0000152587890625  .0000000000000001

// Fixed point 0.16
const u16 X32_atan16[17] =
{
    0xC910, // 0000000000000001.   0  .785400390625      .1100100100010000
    0x76B2, // 000000000000000.1   1  .463653564453125   .0111011010110010
    0x3EB7, // 00000000000000.01   2  .2449798583984375  .0011111010110111
    0x1FD6, // 0000000000000.001   3  .124359130859375   .0001111111010110
    0x0FFB, // 000000000000.0001   4  .0624237060546875  .0000111111111011
    0x07FF, // 00000000000.00001   5  .0312347412109375  .0000011111111111
    0x0400, // 0000000000.000001   6  .015625            .0000010000000000
    0x0200, // 000000000.0000001   7  .0078125           .0000001000000000
    0x0100, // 00000000.00000001   8  .00390625          .0000000100000000
    0x0080, // 0000000.000000001   9  .001953125         .0000000010000000
    0x0040, // 000000.0000000001  10  .0009765625        .0000000001000000
    0x0020, // 00000.00000000001  11  .00048828125       .0000000000100000
    0x0010, // 0000.000000000001  12  .000244140625      .0000000000010000
    0x0008, // 000.0000000000001  13  .0001220703125     .0000000000001000
    0x0004, // 00.00000000000001  14  .00006103515625    .0000000000000100
    0x0002, // 0.000000000000001  15  .000030517578125   .0000000000000010
    0x0001  // .0000000000000001  16  .0000152587890625  .0000000000000001
};

// Sine
// Sine table [0, Pi/2[ ([0, 1024] indices)
const u16 X32_sin[1025] =
{
        0x0000, 0x0006, 0x000D, 0x0013, 0x0019, 0x001F, 0x0026, 0x002C,
        0x0032, 0x0039, 0x003F, 0x0045, 0x004B, 0x0052, 0x0058, 0x005E,
        0x0065, 0x006B, 0x0071, 0x0077, 0x007E, 0x0084, 0x008A, 0x0090,
        0x0097, 0x009D, 0x00A3, 0x00AA, 0x00B0, 0x00B6, 0x00BC, 0x00C3,
        0x00C9, 0x00CF, 0x00D6, 0x00DC, 0x00E2, 0x00E8, 0x00EF, 0x00F5,
        0x00FB, 0x0101, 0x0108, 0x010E, 0x0114, 0x011B, 0x0121, 0x0127,
        0x012D, 0x0134, 0x013A, 0x0140, 0x0146, 0x014D, 0x0153, 0x0159,
        0x015F, 0x0166, 0x016C, 0x0172, 0x0178, 0x017F, 0x0185, 0x018B,
        0x0191, 0x0198, 0x019E, 0x01A4, 0x01AA, 0x01B1, 0x01B7, 0x01BD,
        0x01C3, 0x01CA, 0x01D0, 0x01D6, 0x01DC, 0x01E3, 0x01E9, 0x01EF,
        0x01F5, 0x01FC, 0x0202, 0x0208, 0x020E, 0x0215, 0x021B, 0x0221,
        0x0227, 0x022D, 0x0234, 0x023A, 0x0240, 0x0246, 0x024D, 0x0253,
        0x0259, 0x025F, 0x0265, 0x026C, 0x0272, 0x0278, 0x027E, 0x0284,
        0x028B, 0x0291, 0x0297, 0x029D, 0x02A3, 0x02AA, 0x02B0, 0x02B6,
        0x02BC, 0x02C2, 0x02C9, 0x02CF, 0x02D5, 0x02DB, 0x02E1, 0x02E8,
        0x02EE, 0x02F4, 0x02FA, 0x0300, 0x0306, 0x030D, 0x0313, 0x0319,
        0x031F, 0x0325, 0x032B, 0x0332, 0x0338, 0x033E, 0x0344, 0x034A,
        0x0350, 0x0356, 0x035D, 0x0363, 0x0369, 0x036F, 0x0375, 0x037B,
        0x0381, 0x0388, 0x038E, 0x0394, 0x039A, 0x03A0, 0x03A6, 0x03AC,
        0x03B2, 0x03B9, 0x03BF, 0x03C5, 0x03CB, 0x03D1, 0x03D7, 0x03DD,
        0x03E3, 0x03E9, 0x03EF, 0x03F6, 0x03FC, 0x0402, 0x0408, 0x040E,
        0x0414, 0x041A, 0x0420, 0x0426, 0x042C, 0x0432, 0x0438, 0x043E,
        0x0444, 0x044B, 0x0451, 0x0457, 0x045D, 0x0463, 0x0469, 0x046F,
        0x0475, 0x047B, 0x0481, 0x0487, 0x048D, 0x0493, 0x0499, 0x049F,
        0x04A5, 0x04AB, 0x04B1, 0x04B7, 0x04BD, 0x04C3, 0x04C9, 0x04CF,
        0x04D5, 0x04DB, 0x04E1, 0x04E7, 0x04ED, 0x04F3, 0x04F9, 0x04FF,
        0x0505, 0x050B, 0x0511, 0x0517, 0x051D, 0x0523, 0x0529, 0x052F,
        0x0534, 0x053A, 0x0540, 0x0546, 0x054C, 0x0552, 0x0558, 0x055E,
        0x0564, 0x056A, 0x0570, 0x0576, 0x057C, 0x0581, 0x0587, 0x058D,
        0x0593, 0x0599, 0x059F, 0x05A5, 0x05AB, 0x05B1, 0x05B6, 0x05BC,
        0x05C2, 0x05C8, 0x05CE, 0x05D4, 0x05DA, 0x05DF, 0x05E5, 0x05EB,
        0x05F1, 0x05F7, 0x05FD, 0x0602, 0x0608, 0x060E, 0x0614, 0x061A,
        0x061F, 0x0625, 0x062B, 0x0631, 0x0637, 0x063C, 0x0642, 0x0648,
        0x064E, 0x0654, 0x0659, 0x065F, 0x0665, 0x066B, 0x0670, 0x0676,
        0x067C, 0x0682, 0x0687, 0x068D, 0x0693, 0x0699, 0x069E, 0x06A4,
        0x06AA, 0x06AF, 0x06B5, 0x06BB, 0x06C1, 0x06C6, 0x06CC, 0x06D2,
        0x06D7, 0x06DD, 0x06E3, 0x06E8, 0x06EE, 0x06F4, 0x06F9, 0x06FF,
        0x0705, 0x070A, 0x0710, 0x0715, 0x071B, 0x0721, 0x0726, 0x072C,
        0x0732, 0x0737, 0x073D, 0x0742, 0x0748, 0x074E, 0x0753, 0x0759,
        0x075E, 0x0764, 0x076A, 0x076F, 0x0775, 0x077A, 0x0780, 0x0785,
        0x078B, 0x0790, 0x0796, 0x079B, 0x07A1, 0x07A6, 0x07AC, 0x07B2,
        0x07B7, 0x07BD, 0x07C2, 0x07C8, 0x07CD, 0x07D2, 0x07D8, 0x07DD,
        0x07E3, 0x07E8, 0x07EE, 0x07F3, 0x07F9, 0x07FE, 0x0804, 0x0809,
        0x080E, 0x0814, 0x0819, 0x081F, 0x0824, 0x082A, 0x082F, 0x0834,
        0x083A, 0x083F, 0x0845, 0x084A, 0x084F, 0x0855, 0x085A, 0x085F,
        0x0865, 0x086A, 0x086F, 0x0875, 0x087A, 0x087F, 0x0885, 0x088A,
        0x088F, 0x0895, 0x089A, 0x089F, 0x08A5, 0x08AA, 0x08AF, 0x08B4,
        0x08BA, 0x08BF, 0x08C4, 0x08C9, 0x08CF, 0x08D4, 0x08D9, 0x08DE,
        0x08E4, 0x08E9, 0x08EE, 0x08F3, 0x08F8, 0x08FE, 0x0903, 0x0908,
        0x090D, 0x0912, 0x0918, 0x091D, 0x0922, 0x0927, 0x092C, 0x0931,
        0x0937, 0x093C, 0x0941, 0x0946, 0x094B, 0x0950, 0x0955, 0x095A,
        0x095F, 0x0965, 0x096A, 0x096F, 0x0974, 0x0979, 0x097E, 0x0983,
        0x0988, 0x098D, 0x0992, 0x0997, 0x099C, 0x09A1, 0x09A6, 0x09AB,
        0x09B0, 0x09B5, 0x09BA, 0x09BF, 0x09C4, 0x09C9, 0x09CE, 0x09D3,
        0x09D8, 0x09DD, 0x09E2, 0x09E7, 0x09EC, 0x09F1, 0x09F6, 0x09FB,
        0x09FF, 0x0A04, 0x0A09, 0x0A0E, 0x0A13, 0x0A18, 0x0A1D, 0x0A22,
        0x0A26, 0x0A2B, 0x0A30, 0x0A35, 0x0A3A, 0x0A3F, 0x0A44, 0x0A48,
        0x0A4D, 0x0A52, 0x0A57, 0x0A5C, 0x0A60, 0x0A65, 0x0A6A, 0x0A6F,
        0x0A73, 0x0A78, 0x0A7D, 0x0A82, 0x0A86, 0x0A8B, 0x0A90, 0x0A95,
        0x0A99, 0x0A9E, 0x0AA3, 0x0AA7, 0x0AAC, 0x0AB1, 0x0AB5, 0x0ABA,
        0x0ABF, 0x0AC3, 0x0AC8, 0x0ACD, 0x0AD1, 0x0AD6, 0x0ADB, 0x0ADF,
        0x0AE4, 0x0AE8, 0x0AED, 0x0AF2, 0x0AF6, 0x0AFB, 0x0AFF, 0x0B04,
        0x0B08, 0x0B0D, 0x0B11, 0x0B16, 0x0B1B, 0x0B1F, 0x0B24, 0x0B28,
        0x0B2D, 0x0B31, 0x0B36, 0x0B3A, 0x0B3E, 0x0B43, 0x0B47, 0x0B4C,
        0x0B50, 0x0B55, 0x0B59, 0x0B5E, 0x0B62, 0x0B66, 0x0B6B, 0x0B6F,
        0x0B74, 0x0B78, 0x0B7C, 0x0B81, 0x0B85, 0x0B89, 0x0B8E, 0x0B92,
        0x0B97, 0x0B9B, 0x0B9F, 0x0BA3, 0x0BA8, 0x0BAC, 0x0BB0, 0x0BB5,
        0x0BB9, 0x0BBD, 0x0BC1, 0x0BC6, 0x0BCA, 0x0BCE, 0x0BD2, 0x0BD7,
        0x0BDB, 0x0BDF, 0x0BE3, 0x0BE8, 0x0BEC, 0x0BF0, 0x0BF4, 0x0BF8,
        0x0BFC, 0x0C01, 0x0C05, 0x0C09, 0x0C0D, 0x0C11, 0x0C15, 0x0C19,
        0x0C1E, 0x0C22, 0x0C26, 0x0C2A, 0x0C2E, 0x0C32, 0x0C36, 0x0C3A,
        0x0C3E, 0x0C42, 0x0C46, 0x0C4A, 0x0C4E, 0x0C52, 0x0C56, 0x0C5A,
        0x0C5E, 0x0C62, 0x0C66, 0x0C6A, 0x0C6E, 0x0C72, 0x0C76, 0x0C7A,
        0x0C7E, 0x0C82, 0x0C86, 0x0C8A, 0x0C8E, 0x0C91, 0x0C95, 0x0C99,
        0x0C9D, 0x0CA1, 0x0CA5, 0x0CA9, 0x0CAC, 0x0CB0, 0x0CB4, 0x0CB8,
        0x0CBC, 0x0CC0, 0x0CC3, 0x0CC7, 0x0CCB, 0x0CCF, 0x0CD2, 0x0CD6,
        0x0CDA, 0x0CDE, 0x0CE1, 0x0CE5, 0x0CE9, 0x0CED, 0x0CF0, 0x0CF4,
        0x0CF8, 0x0CFB, 0x0CFF, 0x0D03, 0x0D06, 0x0D0A, 0x0D0E, 0x0D11,
        0x0D15, 0x0D18, 0x0D1C, 0x0D20, 0x0D23, 0x0D27, 0x0D2A, 0x0D2E,
        0x0D32, 0x0D35, 0x0D39, 0x0D3C, 0x0D40, 0x0D43, 0x0D47, 0x0D4A,
        0x0D4E, 0x0D51, 0x0D55, 0x0D58, 0x0D5C, 0x0D5F, 0x0D62, 0x0D66,
        0x0D69, 0x0D6D, 0x0D70, 0x0D74, 0x0D77, 0x0D7A, 0x0D7E, 0x0D81,
        0x0D85, 0x0D88, 0x0D8B, 0x0D8F, 0x0D92, 0x0D95, 0x0D99, 0x0D9C,
        0x0D9F, 0x0DA2, 0x0DA6, 0x0DA9, 0x0DAC, 0x0DB0, 0x0DB3, 0x0DB6,
        0x0DB9, 0x0DBC, 0x0DC0, 0x0DC3, 0x0DC6, 0x0DC9, 0x0DCC, 0x0DD0,
        0x0DD3, 0x0DD6, 0x0DD9, 0x0DDC, 0x0DDF, 0x0DE3, 0x0DE6, 0x0DE9,
        0x0DEC, 0x0DEF, 0x0DF2, 0x0DF5, 0x0DF8, 0x0DFB, 0x0DFE, 0x0E01,
        0x0E04, 0x0E07, 0x0E0A, 0x0E0D, 0x0E10, 0x0E13, 0x0E16, 0x0E19,
        0x0E1C, 0x0E1F, 0x0E22, 0x0E25, 0x0E28, 0x0E2B, 0x0E2E, 0x0E31,
        0x0E34, 0x0E37, 0x0E3A, 0x0E3C, 0x0E3F, 0x0E42, 0x0E45, 0x0E48,
        0x0E4B, 0x0E4D, 0x0E50, 0x0E53, 0x0E56, 0x0E59, 0x0E5B, 0x0E5E,
        0x0E61, 0x0E64, 0x0E66, 0x0E69, 0x0E6C, 0x0E6F, 0x0E71, 0x0E74,
        0x0E77, 0x0E79, 0x0E7C, 0x0E7F, 0x0E81, 0x0E84, 0x0E87, 0x0E89,
        0x0E8C, 0x0E8F, 0x0E91, 0x0E94, 0x0E96, 0x0E99, 0x0E9B, 0x0E9E,
        0x0EA1, 0x0EA3, 0x0EA6, 0x0EA8, 0x0EAB, 0x0EAD, 0x0EB0, 0x0EB2,
        0x0EB5, 0x0EB7, 0x0EBA, 0x0EBC, 0x0EBF, 0x0EC1, 0x0EC3, 0x0EC6,
        0x0EC8, 0x0ECB, 0x0ECD, 0x0ECF, 0x0ED2, 0x0ED4, 0x0ED6, 0x0ED9,
        0x0EDB, 0x0EDD, 0x0EE0, 0x0EE2, 0x0EE4, 0x0EE7, 0x0EE9, 0x0EEB,
        0x0EEE, 0x0EF0, 0x0EF2, 0x0EF4, 0x0EF7, 0x0EF9, 0x0EFB, 0x0EFD,
        0x0EFF, 0x0F02, 0x0F04, 0x0F06, 0x0F08, 0x0F0A, 0x0F0C, 0x0F0E,
        0x0F11, 0x0F13, 0x0F15, 0x0F17, 0x0F19, 0x0F1B, 0x0F1D, 0x0F1F,
        0x0F21, 0x0F23, 0x0F25, 0x0F27, 0x0F29, 0x0F2B, 0x0F2D, 0x0F2F,
        0x0F31, 0x0F33, 0x0F35, 0x0F37, 0x0F39, 0x0F3B, 0x0F3D, 0x0F3F,
        0x0F41, 0x0F43, 0x0F45, 0x0F46, 0x0F48, 0x0F4A, 0x0F4C, 0x0F4E,
        0x0F50, 0x0F51, 0x0F53, 0x0F55, 0x0F57, 0x0F59, 0x0F5A, 0x0F5C,
        0x0F5E, 0x0F60, 0x0F61, 0x0F63, 0x0F65, 0x0F67, 0x0F68, 0x0F6A,
        0x0F6C, 0x0F6D, 0x0F6F, 0x0F71, 0x0F72, 0x0F74, 0x0F76, 0x0F77,
        0x0F79, 0x0F7A, 0x0F7C, 0x0F7D, 0x0F7F, 0x0F81, 0x0F82, 0x0F84,
        0x0F85, 0x0F87, 0x0F88, 0x0F8A, 0x0F8B, 0x0F8D, 0x0F8E, 0x0F90,
        0x0F91, 0x0F93, 0x0F94, 0x0F95, 0x0F97, 0x0F98, 0x0F9A, 0x0F9B,
        0x0F9C, 0x0F9E, 0x0F9F, 0x0FA1, 0x0FA2, 0x0FA3, 0x0FA5, 0x0FA6,
        0x0FA7, 0x0FA8, 0x0FAA, 0x0FAB, 0x0FAC, 0x0FAE, 0x0FAF, 0x0FB0,
        0x0FB1, 0x0FB3, 0x0FB4, 0x0FB5, 0x0FB6, 0x0FB7, 0x0FB8, 0x0FBA,
        0x0FBB, 0x0FBC, 0x0FBD, 0x0FBE, 0x0FBF, 0x0FC0, 0x0FC2, 0x0FC3,
        0x0FC4, 0x0FC5, 0x0FC6, 0x0FC7, 0x0FC8, 0x0FC9, 0x0FCA, 0x0FCB,
        0x0FCC, 0x0FCD, 0x0FCE, 0x0FCF, 0x0FD0, 0x0FD1, 0x0FD2, 0x0FD3,
        0x0FD4, 0x0FD5, 0x0FD5, 0x0FD6, 0x0FD7, 0x0FD8, 0x0FD9, 0x0FDA,
        0x0FDB, 0x0FDC, 0x0FDC, 0x0FDD, 0x0FDE, 0x0FDF, 0x0FE0, 0x0FE0,
        0x0FE1, 0x0FE2, 0x0FE3, 0x0FE3, 0x0FE4, 0x0FE5, 0x0FE6, 0x0FE6,
        0x0FE7, 0x0FE8, 0x0FE8, 0x0FE9, 0x0FEA, 0x0FEA, 0x0FEB, 0x0FEC,
        0x0FEC, 0x0FED, 0x0FED, 0x0FEE, 0x0FEF, 0x0FEF, 0x0FF0, 0x0FF0,
        0x0FF1, 0x0FF1, 0x0FF2, 0x0FF2, 0x0FF3, 0x0FF3, 0x0FF4, 0x0FF4,
        0x0FF5, 0x0FF5, 0x0FF6, 0x0FF6, 0x0FF7, 0x0FF7, 0x0FF8, 0x0FF8,
        0x0FF8, 0x0FF9, 0x0FF9, 0x0FF9, 0x0FFA, 0x0FFA, 0x0FFA, 0x0FFB,
        0x0FFB, 0x0FFB, 0x0FFC, 0x0FFC, 0x0FFC, 0x0FFC, 0x0FFD, 0x0FFD,
        0x0FFD, 0x0FFD, 0x0FFE, 0x0FFE, 0x0FFE, 0x0FFE, 0x0FFE, 0x0FFF,
        0x0FFF, 0x0FFF, 0x0FFF, 0x0FFF, 0x0FFF, 0x0FFF, 0x1000, 0x1000,
        0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000,
    0x1000
};

// Arc Sine
// Arc Sine table
// Input range [0, 1] mapped to [0, 1023] (1024 values)
// Results are in a16, [0, 65536] being equivalent to [0, 2*PI]
const u16 X32_asin[1024] =
{
        0x0000, 0x000A, 0x0014, 0x001F, 0x0029, 0x0033, 0x003D, 0x0047,
        0x0052, 0x005C, 0x0066, 0x0070, 0x007A, 0x0085, 0x008F, 0x0099,
        0x00A3, 0x00AD, 0x00B8, 0x00C2, 0x00CC, 0x00D6, 0x00E0, 0x00EB,
        0x00F5, 0x00FF, 0x0109, 0x0113, 0x011E, 0x0128, 0x0132, 0x013C,
        0x0146, 0x0151, 0x015B, 0x0165, 0x016F, 0x0179, 0x0184, 0x018E,
        0x0198, 0x01A2, 0x01AC, 0x01B7, 0x01C1, 0x01CB, 0x01D5, 0x01DF,
        0x01EA, 0x01F4, 0x01FE, 0x0208, 0x0212, 0x021D, 0x0227, 0x0231,
        0x023B, 0x0245, 0x0250, 0x025A, 0x0264, 0x026E, 0x0279, 0x0283,
        0x028D, 0x0297, 0x02A1, 0x02AC, 0x02B6, 0x02C0, 0x02CA, 0x02D4,
        0x02DF, 0x02E9, 0x02F3, 0x02FD, 0x0308, 0x0312, 0x031C, 0x0326,
        0x0331, 0x033B, 0x0345, 0x034F, 0x0359, 0x0364, 0x036E, 0x0378,
        0x0382, 0x038D, 0x0397, 0x03A1, 0x03AB, 0x03B6, 0x03C0, 0x03CA,
        0x03D4, 0x03DE, 0x03E9, 0x03F3, 0x03FD, 0x0407, 0x0412, 0x041C,
        0x0426, 0x0430, 0x043B, 0x0445, 0x044F, 0x0459, 0x0464, 0x046E,
        0x0478, 0x0482, 0x048D, 0x0497, 0x04A1, 0x04AC, 0x04B6, 0x04C0,
        0x04CA, 0x04D5, 0x04DF, 0x04E9, 0x04F3, 0x04FE, 0x0508, 0x0512,
        0x051D, 0x0527, 0x0531, 0x053B, 0x0546, 0x0550, 0x055A, 0x0564,
        0x056F, 0x0579, 0x0583, 0x058E, 0x0598, 0x05A2, 0x05AD, 0x05B7,
        0x05C1, 0x05CB, 0x05D6, 0x05E0, 0x05EA, 0x05F5, 0x05FF, 0x0609,
        0x0614, 0x061E, 0x0628, 0x0632, 0x063D, 0x0647, 0x0651, 0x065C,
        0x0666, 0x0670, 0x067B, 0x0685, 0x068F, 0x069A, 0x06A4, 0x06AE,
        0x06B9, 0x06C3, 0x06CD, 0x06D8, 0x06E2, 0x06EC, 0x06F7, 0x0701,
        0x070B, 0x0716, 0x0720, 0x072B, 0x0735, 0x073F, 0x074A, 0x0754,
        0x075E, 0x0769, 0x0773, 0x077D, 0x0788, 0x0792, 0x079D, 0x07A7,
        0x07B1, 0x07BC, 0x07C6, 0x07D0, 0x07DB, 0x07E5, 0x07F0, 0x07FA,
        0x0804, 0x080F, 0x0819, 0x0824, 0x082E, 0x0838, 0x0843, 0x084D,
        0x0858, 0x0862, 0x086C, 0x0877, 0x0881, 0x088C, 0x0896, 0x08A1,
        0x08AB, 0x08B5, 0x08C0, 0x08CA, 0x08D5, 0x08DF, 0x08EA, 0x08F4,
        0x08FF, 0x0909, 0x0913, 0x091E, 0x0928, 0x0933, 0x093D, 0x0948,
        0x0952, 0x095D, 0x0967, 0x0972, 0x097C, 0x0987, 0x0991, 0x099C,
        0x09A6, 0x09B1, 0x09BB, 0x09C6, 0x09D0, 0x09DB, 0x09E5, 0x09F0,
        0x09FA, 0x0A05, 0x0A0F, 0x0A1A, 0x0A24, 0x0A2F, 0x0A39, 0x0A44,
        0x0A4E, 0x0A59, 0x0A63, 0x0A6E, 0x0A78, 0x0A83, 0x0A8D, 0x0A98,
        0x0AA3, 0x0AAD, 0x0AB8, 0x0AC2, 0x0ACD, 0x0AD7, 0x0AE2, 0x0AEC,
        0x0AF7, 0x0B02, 0x0B0C, 0x0B17, 0x0B21, 0x0B2C, 0x0B37, 0x0B41,
        0x0B4C, 0x0B56, 0x0B61, 0x0B6C, 0x0B76, 0x0B81, 0x0B8B, 0x0B96,
        0x0BA1, 0x0BAB, 0x0BB6, 0x0BC1, 0x0BCB, 0x0BD6, 0x0BE0, 0x0BEB,
        0x0BF6, 0x0C00, 0x0C0B, 0x0C16, 0x0C20, 0x0C2B, 0x0C36, 0x0C40,
        0x0C4B, 0x0C56, 0x0C60, 0x0C6B, 0x0C76, 0x0C81, 0x0C8B, 0x0C96,
        0x0CA1, 0x0CAB, 0x0CB6, 0x0CC1, 0x0CCB, 0x0CD6, 0x0CE1, 0x0CEC,
        0x0CF6, 0x0D01, 0x0D0C, 0x0D17, 0x0D21, 0x0D2C, 0x0D37, 0x0D42,
        0x0D4C, 0x0D57, 0x0D62, 0x0D6D, 0x0D77, 0x0D82, 0x0D8D, 0x0D98,
        0x0DA3, 0x0DAD, 0x0DB8, 0x0DC3, 0x0DCE, 0x0DD9, 0x0DE3, 0x0DEE,
        0x0DF9, 0x0E04, 0x0E0F, 0x0E1A, 0x0E24, 0x0E2F, 0x0E3A, 0x0E45,
        0x0E50, 0x0E5B, 0x0E66, 0x0E70, 0x0E7B, 0x0E86, 0x0E91, 0x0E9C,
        0x0EA7, 0x0EB2, 0x0EBD, 0x0EC8, 0x0ED2, 0x0EDD, 0x0EE8, 0x0EF3,
        0x0EFE, 0x0F09, 0x0F14, 0x0F1F, 0x0F2A, 0x0F35, 0x0F40, 0x0F4B,
        0x0F56, 0x0F61, 0x0F6C, 0x0F77, 0x0F82, 0x0F8D, 0x0F98, 0x0FA3,
        0x0FAE, 0x0FB9, 0x0FC4, 0x0FCF, 0x0FDA, 0x0FE5, 0x0FF0, 0x0FFB,
        0x1006, 0x1011, 0x101C, 0x1027, 0x1032, 0x103D, 0x1048, 0x1053,
        0x105E, 0x1069, 0x1074, 0x107F, 0x108A, 0x1096, 0x10A1, 0x10AC,
        0x10B7, 0x10C2, 0x10CD, 0x10D8, 0x10E3, 0x10EF, 0x10FA, 0x1105,
        0x1110, 0x111B, 0x1126, 0x1132, 0x113D, 0x1148, 0x1153, 0x115E,
        0x1169, 0x1175, 0x1180, 0x118B, 0x1196, 0x11A2, 0x11AD, 0x11B8,
        0x11C3, 0x11CF, 0x11DA, 0x11E5, 0x11F0, 0x11FC, 0x1207, 0x1212,
        0x121D, 0x1229, 0x1234, 0x123F, 0x124B, 0x1256, 0x1261, 0x126D,
        0x1278, 0x1283, 0x128F, 0x129A, 0x12A5, 0x12B1, 0x12BC, 0x12C8,
        0x12D3, 0x12DE, 0x12EA, 0x12F5, 0x1301, 0x130C, 0x1317, 0x1323,
        0x132E, 0x133A, 0x1345, 0x1351, 0x135C, 0x1368, 0x1373, 0x137E,
        0x138A, 0x1395, 0x13A1, 0x13AC, 0x13B8, 0x13C4, 0x13CF, 0x13DB,
        0x13E6, 0x13F2, 0x13FD, 0x1409, 0x1414, 0x1420, 0x142C, 0x1437,
        0x1443, 0x144E, 0x145A, 0x1466, 0x1471, 0x147D, 0x1488, 0x1494,
        0x14A0, 0x14AB, 0x14B7, 0x14C3, 0x14CE, 0x14DA, 0x14E6, 0x14F2,
        0x14FD, 0x1509, 0x1515, 0x1520, 0x152C, 0x1538, 0x1544, 0x154F,
        0x155B, 0x1567, 0x1573, 0x157F, 0x158A, 0x1596, 0x15A2, 0x15AE,
        0x15BA, 0x15C6, 0x15D1, 0x15DD, 0x15E9, 0x15F5, 0x1601, 0x160D,
        0x1619, 0x1625, 0x1630, 0x163C, 0x1648, 0x1654, 0x1660, 0x166C,
        0x1678, 0x1684, 0x1690, 0x169C, 0x16A8, 0x16B4, 0x16C0, 0x16CC,
        0x16D8, 0x16E4, 0x16F0, 0x16FC, 0x1708, 0x1714, 0x1721, 0x172D,
        0x1739, 0x1745, 0x1751, 0x175D, 0x1769, 0x1775, 0x1782, 0x178E,
        0x179A, 0x17A6, 0x17B2, 0x17BF, 0x17CB, 0x17D7, 0x17E3, 0x17EF,
        0x17FC, 0x1808, 0x1814, 0x1821, 0x182D, 0x1839, 0x1845, 0x1852,
        0x185E, 0x186A, 0x1877, 0x1883, 0x1890, 0x189C, 0x18A8, 0x18B5,
        0x18C1, 0x18CE, 0x18DA, 0x18E6, 0x18F3, 0x18FF, 0x190C, 0x1918,
        0x1925, 0x1931, 0x193E, 0x194A, 0x1957, 0x1963, 0x1970, 0x197D,
        0x1989, 0x1996, 0x19A2, 0x19AF, 0x19BC, 0x19C8, 0x19D5, 0x19E2,
        0x19EE, 0x19FB, 0x1A08, 0x1A14, 0x1A21, 0x1A2E, 0x1A3B, 0x1A47,
        0x1A54, 0x1A61, 0x1A6E, 0x1A7A, 0x1A87, 0x1A94, 0x1AA1, 0x1AAE,
        0x1ABB, 0x1AC7, 0x1AD4, 0x1AE1, 0x1AEE, 0x1AFB, 0x1B08, 0x1B15,
        0x1B22, 0x1B2F, 0x1B3C, 0x1B49, 0x1B56, 0x1B63, 0x1B70, 0x1B7D,
        0x1B8A, 0x1B97, 0x1BA4, 0x1BB1, 0x1BBE, 0x1BCC, 0x1BD9, 0x1BE6,
        0x1BF3, 0x1C00, 0x1C0D, 0x1C1B, 0x1C28, 0x1C35, 0x1C42, 0x1C50,
        0x1C5D, 0x1C6A, 0x1C77, 0x1C85, 0x1C92, 0x1C9F, 0x1CAD, 0x1CBA,
        0x1CC8, 0x1CD5, 0x1CE2, 0x1CF0, 0x1CFD, 0x1D0B, 0x1D18, 0x1D26,
        0x1D33, 0x1D41, 0x1D4E, 0x1D5C, 0x1D6A, 0x1D77, 0x1D85, 0x1D92,
        0x1DA0, 0x1DAE, 0x1DBB, 0x1DC9, 0x1DD7, 0x1DE4, 0x1DF2, 0x1E00,
        0x1E0E, 0x1E1B, 0x1E29, 0x1E37, 0x1E45, 0x1E53, 0x1E61, 0x1E6F,
        0x1E7C, 0x1E8A, 0x1E98, 0x1EA6, 0x1EB4, 0x1EC2, 0x1ED0, 0x1EDE,
        0x1EEC, 0x1EFA, 0x1F08, 0x1F17, 0x1F25, 0x1F33, 0x1F41, 0x1F4F,
        0x1F5D, 0x1F6C, 0x1F7A, 0x1F88, 0x1F96, 0x1FA5, 0x1FB3, 0x1FC1,
        0x1FD0, 0x1FDE, 0x1FEC, 0x1FFB, 0x2009, 0x2018, 0x2026, 0x2034,
        0x2043, 0x2051, 0x2060, 0x206F, 0x207D, 0x208C, 0x209A, 0x20A9,
        0x20B8, 0x20C6, 0x20D5, 0x20E4, 0x20F3, 0x2101, 0x2110, 0x211F,
        0x212E, 0x213D, 0x214C, 0x215B, 0x2169, 0x2178, 0x2187, 0x2196,
        0x21A5, 0x21B4, 0x21C4, 0x21D3, 0x21E2, 0x21F1, 0x2200, 0x220F,
        0x221F, 0x222E, 0x223D, 0x224C, 0x225C, 0x226B, 0x227A, 0x228A,
        0x2299, 0x22A9, 0x22B8, 0x22C8, 0x22D7, 0x22E7, 0x22F6, 0x2306,
        0x2315, 0x2325, 0x2335, 0x2345, 0x2354, 0x2364, 0x2374, 0x2384,
        0x2394, 0x23A3, 0x23B3, 0x23C3, 0x23D3, 0x23E3, 0x23F3, 0x2403,
        0x2413, 0x2424, 0x2434, 0x2444, 0x2454, 0x2464, 0x2475, 0x2485,
        0x2495, 0x24A6, 0x24B6, 0x24C7, 0x24D7, 0x24E8, 0x24F8, 0x2509,
        0x2519, 0x252A, 0x253B, 0x254B, 0x255C, 0x256D, 0x257E, 0x258E,
        0x259F, 0x25B0, 0x25C1, 0x25D2, 0x25E3, 0x25F4, 0x2605, 0x2617,
        0x2628, 0x2639, 0x264A, 0x265C, 0x266D, 0x267E, 0x2690, 0x26A1,
        0x26B3, 0x26C4, 0x26D6, 0x26E7, 0x26F9, 0x270B, 0x271D, 0x272E,
        0x2740, 0x2752, 0x2764, 0x2776, 0x2788, 0x279A, 0x27AC, 0x27BE,
        0x27D1, 0x27E3, 0x27F5, 0x2807, 0x281A, 0x282C, 0x283F, 0x2851,
        0x2864, 0x2877, 0x2889, 0x289C, 0x28AF, 0x28C2, 0x28D5, 0x28E8,
        0x28FB, 0x290E, 0x2921, 0x2934, 0x2947, 0x295A, 0x296E, 0x2981,
        0x2995, 0x29A8, 0x29BC, 0x29CF, 0x29E3, 0x29F7, 0x2A0B, 0x2A1F,
        0x2A33, 0x2A47, 0x2A5B, 0x2A6F, 0x2A83, 0x2A97, 0x2AAC, 0x2AC0,
        0x2AD5, 0x2AE9, 0x2AFE, 0x2B13, 0x2B27, 0x2B3C, 0x2B51, 0x2B66,
        0x2B7B, 0x2B91, 0x2BA6, 0x2BBB, 0x2BD1, 0x2BE6, 0x2BFC, 0x2C11,
        0x2C27, 0x2C3D, 0x2C53, 0x2C69, 0x2C7F, 0x2C95, 0x2CAB, 0x2CC2,
        0x2CD8, 0x2CEF, 0x2D05, 0x2D1C, 0x2D33, 0x2D4A, 0x2D61, 0x2D78,
        0x2D8F, 0x2DA7, 0x2DBE, 0x2DD6, 0x2DED, 0x2E05, 0x2E1D, 0x2E35,
        0x2E4D, 0x2E66, 0x2E7E, 0x2E97, 0x2EAF, 0x2EC8, 0x2EE1, 0x2EFA,
        0x2F13, 0x2F2D, 0x2F46, 0x2F60, 0x2F79, 0x2F93, 0x2FAD, 0x2FC8,
        0x2FE2, 0x2FFD, 0x3017, 0x3032, 0x304D, 0x3068, 0x3084, 0x309F,
        0x30BB, 0x30D7, 0x30F3, 0x3110, 0x312C, 0x3149, 0x3166, 0x3183,
        0x31A0, 0x31BE, 0x31DC, 0x31FA, 0x3218, 0x3237, 0x3256, 0x3275,
        0x3294, 0x32B4, 0x32D4, 0x32F4, 0x3315, 0x3335, 0x3357, 0x3378,
        0x339A, 0x33BC, 0x33DF, 0x3402, 0x3425, 0x3449, 0x346D, 0x3492,
        0x34B7, 0x34DC, 0x3502, 0x3529, 0x3550, 0x3577, 0x35A0, 0x35C8,
        0x35F2, 0x361C, 0x3647, 0x3672, 0x369E, 0x36CB, 0x36F9, 0x3728,
        0x3758, 0x3789, 0x37BB, 0x37EE, 0x3823, 0x3858, 0x3890, 0x38C9,
        0x3904, 0x3940, 0x397F, 0x39C1, 0x3A05, 0x3A4C, 0x3A97, 0x3AE7,
        0x3B3B, 0x3B96, 0x3BF8, 0x3C65, 0x3CE1, 0x3D74, 0x3E33, 0x4000
};

// Arc Tangent
// Arc Tangent table
// Input range [0, 1] mapped to [0, 128] (129 values)
// Results are in a16, [0, 65536] being equivalent to [0, 2*PI]
const u16 X32_atan[129] =
{
        0x0000, 0x0051, 0x00A3, 0x00F4, 0x0146, 0x0197, 0x01E9, 0x023A,
        0x028B, 0x02DC, 0x032D, 0x037E, 0x03CF, 0x0420, 0x0470, 0x04C1,
        0x0511, 0x0561, 0x05B1, 0x0601, 0x0651, 0x06A0, 0x06EF, 0x073E,
        0x078D, 0x07DC, 0x082A, 0x0878, 0x08C6, 0x0914, 0x0961, 0x09AE,
        0x09FB, 0x0A48, 0x0A94, 0x0AE0, 0x0B2C, 0x0B77, 0x0BC2, 0x0C0D,
        0x0C57, 0x0CA1, 0x0CEB, 0x0D34, 0x0D7D, 0x0DC6, 0x0E0F, 0x0E56,
        0x0E9E, 0x0EE5, 0x0F2C, 0x0F73, 0x0FB9, 0x0FFF, 0x1044, 0x1089,
        0x10CE, 0x1112, 0x1156, 0x1199, 0x11DC, 0x121F, 0x1261, 0x12A3,
        0x12E4, 0x1325, 0x1366, 0x13A6, 0x13E6, 0x1425, 0x1464, 0x14A2,
        0x14E0, 0x151E, 0x155B, 0x1598, 0x15D5, 0x1611, 0x164C, 0x1688,
        0x16C2, 0x16FD, 0x1737, 0x1770, 0x17AA, 0x17E2, 0x181B, 0x1853,
        0x188A, 0x18C1, 0x18F8, 0x192E, 0x1964, 0x199A, 0x19CF, 0x1A04,
        0x1A38, 0x1A6C, 0x1A9F, 0x1AD3, 0x1B05, 0x1B38, 0x1B6A, 0x1B9C,
        0x1BCD, 0x1BFE, 0x1C2E, 0x1C5E, 0x1C8E, 0x1CBE, 0x1CED, 0x1D1B,
        0x1D4A, 0x1D78, 0x1DA5, 0x1DD3, 0x1DFF, 0x1E2C, 0x1E58, 0x1E84,
        0x1EB0, 0x1EDB, 0x1F06, 0x1F30, 0x1F5A, 0x1F84, 0x1FAE, 0x1FD7,
        0x2000
};

